const authParams = {
  client_id: YOUR_CLIENT_ID,
  redirect_uri: YOUR_REDIRECT_URI,
  scope: 'email profile',
  state: generateRandomState(),
  response_type: 'code'
};

sessionStorage.setItem('oauth_state', authParams.state);

const authUrl = `https://accounts.google.com/o/oauth2/auth?${new URLSearchParams(authParams)}`;
window.location.replace(authUrl);

const generateRandomState = () => {
  // Use URL-safe characters only
  const urlSafeChars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_';
  let result = '';
  const length = 32;
  
  for (let i = 0; i < length; i++) {
    result += urlSafeChars.charAt(Math.floor(Math.random() * urlSafeChars.length));
  }
  
  return result;
}; 